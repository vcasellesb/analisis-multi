"airpoll" <- 
  structure(.Data = list("Rainfall" = c(36., 35., 44., 47., 43., 53., 43., 45., 36., 36., 52., 33., 40., 35., 37., 35., 36., 15., 31., 30., 31., 31.,
                                        42., 43., 46., 39., 35., 43., 11., 30., 50., 60., 30., 25., 45., 46., 54., 42., 42., 36., 37., 42., 41.,
                                        44., 32., 34., 10., 18., 13., 35., 45., 38., 31., 40., 41., 28., 45., 45., 42., 38.)
                         , "Education" = c(11.4, 11., 9.8000000000000007, 11.1, 9.5999999999999996, 10.199999999999999, 12.1, 10.6, 10.5, 10.699999999999999,
                                           9.5999999999999996, 10.9, 10.199999999999999, 11.1, 11.9, 11.800000000000001, 11.4, 12.199999999999999,
                                           10.800000000000001, 10.800000000000001, 11.4, 10.9, 10.4, 11.5, 11.4, 11.4, 12., 9.5, 12.1, 
                                           9.9000000000000004, 10.4, 11.5, 11.1, 12.1, 10.1, 11.300000000000001, 9.6999999999999993, 
                                           10.699999999999999, 10.5, 10.6, 12., 10.1, 9.5999999999999996, 11., 11.1, 9.6999999999999993, 12.1, 
                                           12.199999999999999, 12.199999999999999, 12.199999999999999, 11.1, 11.4, 10.699999999999999, 
                                           10.300000000000001, 12.300000000000001, 12.1, 11.300000000000001, 11.1, 9., 10.699999999999999)
                         , "Popden" = c(3243., 4281., 4260., 3125., 6441., 3325., 4679., 2140., 6582., 4213., 2302., 6122., 4101., 3042., 4259., 1441.,
                                        4029., 4824., 4834., 3694., 1844., 3226., 2269., 2909., 2647., 4412., 3262., 3214., 4700., 4474., 3497.,
                                        4657., 2934., 2095., 2082., 3327., 3172., 7462., 6092., 3437., 3387., 3508., 4843., 3768., 4355., 5160.,
                                        3033., 4253., 2702., 3626., 1883., 4923., 3249., 1671., 5308., 3665., 3152., 3678., 9699., 3451.)
                         , "Nonwhite" = c(8.8000000000000007, 3.5, 0.80000000000000004, 27.100000000000001, 24.399999999999999, 38.5, 3.5, 
                                          5.2999999999999998, 8.0999999999999996, 6.7000000000000002, 22.199999999999999, 16.300000000000001, 13.,
                                          14.699999999999999, 13.1, 14.800000000000001, 12.4, 4.7000000000000002, 15.800000000000001, 13.1, 11.5,
                                          5.0999999999999996, 22.699999999999999, 7.2000000000000002, 21., 15.6, 12.6, 2.8999999999999999, 
                                          7.7999999999999998, 13.1, 36.700000000000003, 13.5, 5.7999999999999998, 2., 21., 8.8000000000000007, 
                                          31.399999999999999, 11.300000000000001, 17.5, 8.0999999999999996, 3.6000000000000001, 2.2000000000000002,
                                          2.7000000000000002, 28.600000000000001, 5., 17.199999999999999, 5.9000000000000004, 13.699999999999999,
                                          3., 5.7000000000000002, 3.3999999999999999, 3.7999999999999998, 9.5, 2.5, 25.899999999999999, 7.5, 12.1,
                                          1., 4.7999999999999998, 11.699999999999999)
                         , "NOX" = c(15., 10., 6., 8., 38., 32., 32., 4., 12., 7., 8., 63., 26., 21., 9., 1., 4., 8., 35., 4., 1., 3., 3., 3., 5.,
                                     7., 4., 7., 319., 37., 18., 1., 23., 11., 14., 3., 17., 26., 32., 59., 21., 4., 11., 9., 4., 15., 66.,
                                     171., 32., 7., 4., 5., 7., 2., 28., 2., 11., 3., 8., 13.)
                         , "SO2" = c(59., 39., 33., 24., 206., 72., 62., 4., 37., 20., 27., 278., 146., 64., 15., 1., 16., 28., 124., 11., 1., 10.,
                                     5., 10., 1., 33., 4., 32., 130., 193., 34., 1., 125., 26., 78., 8., 1., 108., 161., 263., 44., 18., 89.,
                                     48., 18., 68., 20., 86., 3., 20., 20., 25., 25., 11., 102., 1., 42., 8., 49., 39.)
                         , "Mortality" = c(921.89999999999998, 997.89999999999998, 962.39999999999998, 982.29999999999995, 1071., 1030., 934.70000000000005,
                                           899.5, 1002., 912.29999999999995, 1018., 1025., 970.5, 986., 958.79999999999995, 860.10000000000002, 
                                           936.20000000000005, 871.79999999999995, 959.20000000000005, 941.20000000000005, 891.70000000000005, 
                                           871.29999999999995, 971.10000000000002, 887.5, 952.5, 968.70000000000005, 919.70000000000005, 
                                           844.10000000000002, 861.79999999999995, 989.29999999999995, 1006., 861.39999999999998, 929.20000000000005,
                                           857.60000000000002, 961., 923.20000000000005, 1113., 994.60000000000002, 1015., 991.29999999999995, 894.,
                                           938.5, 946.20000000000005, 1026., 874.29999999999995, 953.60000000000002, 839.70000000000005, 
                                           911.70000000000005, 790.70000000000005, 899.29999999999995, 904.20000000000005, 950.70000000000005, 972.5,
                                           912.20000000000005, 968.79999999999995, 823.79999999999995, 1004., 895.70000000000005, 911.79999999999995,
                                           954.39999999999998)
  )
  , names = c("Rainfall", "Education", "Popden", "Nonwhite", "NOX", "SO2", "Mortality")
  , class = "data.frame"
  , row.names = c("akronOH", "albanyNY", "allenPA", "atlantGA", "baltimMD", "birmhmAL", "bostonMA", "bridgeCT", "bufaloNY", 
                  "cantonOH", "chatagTN", "chicagIL", "cinnciOH", "clevelOH", "colombOH", "dallasTX", "daytonOH", "denverCO",
                  "detrotMI", "flintMI", "ftwortTX", "grndraMI", "grnborNC", "hartfdCT", "houstnTX", "indianIN", "kansasMO",
                  "lancasPA", "losangCA", "louisvKY", "memphsTN", "miamiFL", "milwauWI", "minnplMN", "nashvlTN", "newhvnCT",
                  "neworlLA", "newyrkNY", "philadPA", "pittsbPA", "portldOR", "provdcRI", "readngPA", "richmdVA", "rochtrNY",
                  "stlousMO", "sandigCA", "sanfrnCA", "sanjosCA", "seatleWA", "springMA", "syracuNY", "toledoOH", "uticaNY",
                  "washDC", "wichtaKS", "wilmtnDE", "worctrMA", "yorkPA", "youngsOH")
  )


source('biv.R')
uni <- univarden(x = airpoll$Mortality)
plot(uni$seqx, uni$den, type='l')
